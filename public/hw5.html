<!DOCTYPE html>
<html lang="en">
<head>
  <title>HW 5</title>
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta.2/css/bootstrap.min.css" integrity="sha384-PsH8R72JQ3SOdhVi3uxftmaW6Vc51MKb0q5P2rRUpPvrszuE4W1povHYgTpBfshb" crossorigin="anonymous">
  <link rel="stylesheet" href="./css/homepage.css">
</head>
<body>
  <h1>CSE 134B: Jeff Evans Fan Club</h1>
  <nav class="navbar navbar-expand-lg navbar-light">
    <a class="navbar-brand" href="#">LINKS:</a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarNav">
      <ul class="navbar-nav">
        <li class="nav-item">
          <a class="nav-link" href="./index.html">HOME</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="./hw2.html">HW 2</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="./hw3.html">HW 3</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="/hw4.html">HW 4</a>
        </li>
        <li class="nav-item active">
          <a class="nav-link" href="/hw5.html">HW 5</a>
        </li>
      </ul>
    </div>
  </nav>
  <div class="container">
    <div class="row">
      <div class="col">
        <article>
          <h2>HW 5</h2>
          <p>
            In the previous assignment we made our Soccer Application "work," but we did not fully integrate it with a cloud hosted environment nor prepare it for the final release to production. In this final assignment we finish wiring up the application and make it work as a highly resilient progressive web application (PWA) that performs excellently on our median Android phone throttled to a 3G connection. We aim to do this using plain Vanilla JavaScript with some assistance from a Google library, though an extra credit section will allow you to explore another approach using a modern JavaScript framework of your choice.
          </p>
        </article>
      </div>
    </div>
  </div>
  <div class="container">
    <div class="row">
      <div class="col">
        <article>
          <h2>Links</h2>
          <ul>
            <li>
              <a href="./build/index.html">TeamWatch (minified)</a>
            </li>
            <li>
              <a href="./build-uncompact/index.html">TeamWatch</a>
            </li>
          </ul>
        </article>
      </div>
    </div>
  </div>
  <div class="container">
    <div class="row">
      <div class="col">
        <article>
          <h2>App Details</h2>
          <p>
            TeamWatch is provides users with a convenient solution for managing soccer teams. Coaches are able to create an account with their team. They are then able to add their respective players and games with their opponents. They would be able to also edit their players and games. The app is able to consolidates the stats and shows each of the games stats. Coaches would also be given an access code which they could distribute to players and fans, so they too could also track the team’s progress and stats.
          </p>
        </article>
      </div>
    </div>
  </div>
  <div class="container">
    <div class="row">
      <div class="col">
        <article>
          <h2>Login Details</h2>
          <p>
            Users are given three options to sign up with: as a coach, as a player, or as a fan. When you sign up as a coach, you are also creating a team in which you are the coach of. As a coach you are given access, to all the CRUD operations, as you are able to add, edit, and delete players, games, game statistics, and opponents. When you are creating an account as a player or a fan, you must enter an access code of a team, and you are able to view the team data.
          </p>
        </article>
      </div>
    </div>
  </div>
  <div class="container">
    <div class="row">
      <div class="col">
        <article>
          <h2>Data Management</h2>
          <div class="datastructure">
            <p>
              Our database is organized as:
            </p>
            <p>users/</p>
            <p>&emsp;team</p>
            <p>&emsp;admin</p>
            <p>teams/</p>
            <p>&emsp;name</p>
            <p>&emsp;logo</p>
            <p>&emsp;games/</p>
            <p>&emsp;&emsp;active</p>
            <p>&emsp;&emsp;date</p>
            <p>&emsp;&emsp;location</p>
            <p>&emsp;&emsp;opponent</p>
            <p>&emsp;&emsp;time</p>
            <p>&emsp;stats/</p>
            <p>&emsp;&emsp;stat</p>
            <p>&emsp;players/</p>
            <p>&emsp;&emsp;name</p>
            <p>&emsp;&emsp;number</p>
            <p>&emsp;&emsp;position</p>
            <p>&emsp;&emsp;image</p>
            <p>&emsp;&emsp;stats</p>
            <p>&emsp;opponents/</p>
            <p>&emsp;&emsp;logo</p>
            <p>&emsp;&emsp;name</p>
          </div>
          <p>
            We used Firebase for our authentication, and database using Firestore. When users create accounts they we use FirebaseAuth to authenticate and create their accounts. When a user account is created, a user account is created in the database with a team and admin field. The team’s of the user accounts contain the team name, its logo, and a collection of games, players, and opponents. Games contains whether it is active, the date, location, opponent, time, and a collection of stats. Players has the name, number, position, image, and their stats such as goals scored and yellow cards. Lastly the opponent collection only stores the logo and name of the opponent, which is used to display the versus page.
          </p>
          <p>
            We decided to go with this approach, because each of the users have their individual teams that they follow.  In addition, the way firestore organizes data, allows us to query the individual properties of each of the collections, without returning the subcollections. This allows us to make minimal network calls to get what we want when we need it.
          </p>
          <p>
            By using firestore, we were able to able allow for offline persistence, which allows for offline CRUD.
          </p>
        </article>
      </div>
    </div>
  </div>
  <div class="container">
    <div class="row">
      <div class="col">
        <article>
          <h2>PWA</h2>
          <p>
            We used webwork to generate the service worker. The service worker caches all the html, css, and javascript files. For the more dynamic pages, we used network first because the user needs to see the more recent data on those pages. Our app passes the Lighthouse test for PWA.
          </p>
        </article>
      </div>
    </div>
  </div>
  <div class="container">
    <div class="row">
      <div class="col">
        <article>
          <h2>Optimizations</h2>
          <p>
            In addition to using service workers with workbox and offline persistence with Firestore, we also use minification and image compression. For minification, we used a gulp-minifier, which  uses html-minifier, UglifyJS, and Clean CSS. We used Optimizilla to compress our images, which significantly reduced the file sizes.
          </p>
        </article>
      </div>
    </div>
  </div>
  <div class="container">
    <div class="row">
      <div class="col">
        <article>
          <h2>Assessment</h2>
          <p>
            While we believe we added a fair amount of features in our application, there were a few things that did not work and we think could have been improved on. In general, our code quality is not consistent, as each of the team members did their respective parts and we did not have a consolidated pattern or guideline to follow. This applies to the JS and CSS, as both could be better written, but we lacked to time to organize it. In addition, we feel we may have included some additional network calls to retrieve the data for the pages. We could have reformatted the organizational structure of the data,  figured better, more efficient ways to query things on a page, or looked more into caching. Thus, our performance takes a bit of a hit on the pages in which we have to make multiple network calls. While our app was able to pass Lighthouse’s PWA test, we found that the add to home page and the splash screen did not seem to work. Also, while we used Firestore for offline persistence, we found that it did not seem to work too well with adding/editing things in the database while offline. There would be network errors that would appear in the console, though the data would be added when the page is refreshed. Lastly we found that minifying the page caused problems with registering the service worker.
          </p>
        </article>
      </div>
    </div>
  </div>
  <div class="container">
    <div class="row">
      <div class="col">
        <article>
          <h2>Load Time and Size Analysis:</h2>
          <table>
            <tr>
              <th>Page</th>
              <th>Load Time</th>
              <th>Page Size</th>
            </tr>
            <tr>
              <td><a href="https://cse134-bfd99.firebaseapp.com/build/login.html">Login</a></td>
              <td>861 ms</td>
              <td>1.5 KB</td>
            </tr>
            <tr>
              <td><a href="https://cse134-bfd99.firebaseapp.com/build/signup.html">Sign Up</a></td>
              <td>811 ms</td>
              <td>1.5 KB</td>
            </tr>
            <tr>
              <td><a href="https://cse134-bfd99.firebaseapp.com/build/signup_invite.html">Coach Sign Up</a></td>
              <td>828 ms</td>
              <td>2.1 KB</td>
            </tr>
            <tr>
              <td><a href="https://cse134-bfd99.firebaseapp.com/build/signup_new.html">Player Sign Up</a></td>
              <td>806 ms</td>
              <td>2.1 KB</td>
            </tr>
            <tr>
              <td><a href="https://cse134-bfd99.firebaseapp.com/build/team.html">Home Page</a></td>
              <td>892 ms</td>
              <td>3.9 KB</td>
            </tr>
            <tr>
              <td><a href="https://cse134-bfd99.firebaseapp.com/build/schedule.html">Schedule</a></td>
              <td>897 ms</td>
              <td>3.5 KB</td>
            </tr>
            <tr>
              <td><a href="https://cse134-bfd99.firebaseapp.com/build/gamedetails.html">Game Detail</a></td>
              <td>951 ms</td>
              <td>6.3 KB</td>
            </tr>
            <tr>
              <td><a href="https://cse134-bfd99.firebaseapp.com/build/addgame.html">Add Game</a></td>
              <td>875 ms</td>
              <td>2.6 KB</td>
            </tr>
            <tr>
              <td><a href="https://cse134-bfd99.firebaseapp.com/build/editgame.html">Edit Game</a></td>
              <td>926 ms</td>
              <td>3.0 KB</td>
            </tr>
            <tr>
              <td><a href="https://cse134-bfd99.firebaseapp.com/build/addevent.html">Add Event</a></td>
              <td>904 ms</td>
              <td>2.5 KB</td>
            </tr>
            <tr>
              <td><a href="https://cse134-bfd99.firebaseapp.com/build/players.html">Players</a></td>
              <td>933 ms</td>
              <td>5.2 KB</td>
            </tr>
            <tr>
              <td><a href="https://cse134-bfd99.firebaseapp.com/build/addplayer.html">Add Player</a></td>
              <td>887 ms</td>
              <td>2.5 KB</td>
            </tr>
            <tr>
              <td><a href="https://cse134-bfd99.firebaseapp.com/build/editplayer.html">Edit Player</a></td>
              <td>936 ms</td>
              <td>3.5 KB</td>
            </tr>
            <tr>
              <td><a href="https://cse134-bfd99.firebaseapp.com/build/playerdetails.html">Player Details</a></td>
              <td>922 ms</td>
              <td>2.2 KB</td>
            </tr>
            <tr>
              <td><a href="https://cse134-bfd99.firebaseapp.com/build/settings.html">Settings</a></td>
              <td>951 ms</td>
              <td>3.2 KB</td>
            </tr>
            <tr>
              <td><a href="https://cse134-bfd99.firebaseapp.com/build/editteam.html">Edit Team Information</a></td>
              <td>974 ms</td>
              <td>4.0 KB</td>
            </tr>
            <tr>
              <td><a href="https://cse134-bfd99.firebaseapp.com/build/manageopponents.html">Manage Opponents</a></td>
              <td>888 ms</td>
              <td>2.5 KB</td>
            </tr>
          </table>
          <p>We ran our performance analysis of the optimized version of our website on a device running Android 5.1.1. We used the Chrome DevTools to emulate the device running on a Slow 3G network.</p>
        </article>
      </div>
    </div>
  </div>
  <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.3/umd/popper.min.js" integrity="sha384-vFJXuSJphROIrBnz7yo7oB41mKfc8JzQZiCq4NCceLEaO4IHwicKwpJf9c9IpFgh" crossorigin="anonymous"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta.2/js/bootstrap.min.js" integrity="sha384-alpBpkh1PFOepccYVYDB4do5UnbKysX5WZXm3XxPqe5iKTfUKjNkCk9SaVuEZflJ" crossorigin="anonymous"></script>
</body>
</html>
